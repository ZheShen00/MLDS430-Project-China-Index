{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-11-28T00:34:25.869020Z", "invocation_id": "de67e221-6db6-4f64-aff6-dc67f73a5305", "invocation_started_at": "2025-11-28T00:34:19.596470Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T00:34:25.542872Z", "completed_at": "2025-11-28T00:34:25.558495Z"}, {"name": "execute", "started_at": "2025-11-28T00:34:25.560449Z", "completed_at": "2025-11-28T00:34:25.560449Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021483898162841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.index_dbt.dim_date", "compiled": true, "compiled_code": "\n\nwith dates as (\n\n    -- \u4ece 2019-01-01 \u5f00\u59cb\u751f\u6210\u5927\u7ea6 6 \u5e74\u7684\u65e5\u671f\uff08\u8db3\u591f\u8986\u76d6 2019-2023\uff09\n    select\n        dateadd(\n            day,\n            row_number() over (order by 0) - 1,\n            to_date('2019-01-01')\n        ) as full_date\n    from table(generator(rowcount => 365 * 6))\n\n)\n\nselect\n    -- \u548c stg_index_daily \u91cc\u7684 date_key \u89c4\u5219\u4fdd\u6301\u4e00\u81f4\n    to_number(to_char(full_date, 'YYYYMMDD')) as date_key,\n    full_date,\n\n    extract(year   from full_date) as year,\n    extract(month  from full_date) as month,\n    extract(day    from full_date) as day,\n    extract(quarter from full_date) as quarter,\n    to_char(full_date, 'DY')       as weekday_short,\n    to_char(full_date, 'DAY')      as weekday_full\n\nfrom dates", "relation_name": "FIVETRAN_DATABASE.MLDS430_KOALA_INDEX_RAW.dim_date", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T00:34:25.552634Z", "completed_at": "2025-11-28T00:34:25.559473Z"}, {"name": "execute", "started_at": "2025-11-28T00:34:25.561423Z", "completed_at": "2025-11-28T00:34:25.561423Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0214841365814209, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.index_dbt.stg_index_daily", "compiled": true, "compiled_code": "\n\nwith raw as (\n\n    select\n        -- date \u5217\u662f 20190102 \u8fd9\u79cd\u6574\u6570\uff0c\u5148\u8f6c\u6210\u5b57\u7b26\u4e32\u518d\u8f6c DATE\n        to_date(to_char(\"DATE\"), 'YYYYMMDD') as trade_date,\n\n        -- table_name \u662f\u6307\u6570ID\uff081000001\u7b49\uff09\uff0c\u7edf\u4e00\u8f6c\u6210\u5b57\u7b26\u4e32 index_code\n        cast(table_name as varchar) as index_code,\n\n        -- \u6620\u5c04\u4ef7\u683c\u548c\u6210\u4ea4\u91cf\u76f8\u5173\u5b57\u6bb5\n        cast(o as float) as open,\n        cast(h as float) as high,\n        cast(l as float) as low,\n        cast(c as float) as close,\n        cast(v as float) as volume,\n        cast(a as float) as amount\n\n    from FIVETRAN_DATABASE.MLDS430_KOALA_INDEX_RAW.INDEX_DAILY_2019_2023_FILTERED\n\n    -- \u5982\u679c\u4f60\u60f3\u53ea\u4fdd\u7559\u90e8\u5206\u6307\u6570\uff0c\u53ef\u4ee5\u5728\u8fd9\u91cc\u52a0 where table_name in (...)\n    -- where table_name in (1000001, 2399001, 2399006, ...)\n\n)\n\nselect\n    trade_date,\n    index_code,\n    open, high, low, close,\n    volume, amount,\n\n    -- \u7528 trade_date \u751f\u6210\u65e5\u671f\u952e\n    to_number(to_char(trade_date, 'YYYYMMDD')) as date_key,\n\n    -- \u751f\u6210\u4e00\u4e2a\u552f\u4e00\u952e\uff0c\u65b9\u4fbf\u5efa unique test\n    index_code || '_' || to_char(trade_date, 'YYYYMMDD') as unique_key\n\nfrom raw", "relation_name": "FIVETRAN_DATABASE.MLDS430_KOALA_INDEX_RAW.stg_index_daily", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T00:34:25.572167Z", "completed_at": "2025-11-28T00:34:25.607322Z"}, {"name": "execute", "started_at": "2025-11-28T00:34:25.610250Z", "completed_at": "2025-11-28T00:34:25.610250Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04491925239562988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.index_dbt.not_null_dim_date_date_key.881d0a31b6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_key\nfrom FIVETRAN_DATABASE.MLDS430_KOALA_INDEX_RAW.dim_date\nwhere date_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T00:34:25.587788Z", "completed_at": "2025-11-28T00:34:25.607322Z"}, {"name": "execute", "started_at": "2025-11-28T00:34:25.612202Z", "completed_at": "2025-11-28T00:34:25.612202Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.045893192291259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.index_dbt.unique_dim_date_date_key.0869fd48f9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_key as unique_field,\n    count(*) as n_records\n\nfrom FIVETRAN_DATABASE.MLDS430_KOALA_INDEX_RAW.dim_date\nwhere date_key is not null\ngroup by date_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T00:34:25.595600Z", "completed_at": "2025-11-28T00:34:25.609277Z"}, {"name": "execute", "started_at": "2025-11-28T00:34:25.614158Z", "completed_at": "2025-11-28T00:34:25.614158Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.046875953674316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.index_dbt.fact_index_daily", "compiled": true, "compiled_code": "\n\n-- \u5148\u4ece stg_index_daily \u62ff\u5230\u5e72\u51c0\u65e5\u7ebf\u6570\u636e\uff0c\u5e76\u7b97\u524d\u4e00\u65e5\u6536\u76d8\u4ef7\nwith base as (\n\n    select\n        s.date_key,\n        s.trade_date,\n        s.index_code,\n        s.open, s.high, s.low, s.close,\n        s.volume, s.amount,\n\n        lag(s.close) over (\n            partition by s.index_code\n            order by s.trade_date\n        ) as prev_close\n\n    from FIVETRAN_DATABASE.MLDS430_KOALA_INDEX_RAW.stg_index_daily s\n),\n\n-- \u5728 base \u7684\u57fa\u7840\u4e0a\u8ba1\u7b97\u65e5\u6536\u76ca\u548c\u6eda\u52a8\u6307\u6807\nreturns as (\n\n    select\n        *,\n        case \n            when prev_close is null or prev_close = 0 then 0\n            else (close / prev_close) - 1\n        end as daily_return,\n\n        -- \u5bf9\u6570\u7d2f\u8ba1\u6536\u76ca\uff08\u5148\u7d2f\u79ef log(1+r)\uff0c\u540e\u9762\u518d exp \u56de\u6765\uff09\n        sum(\n            ln(\n                1 + case\n                        when prev_close is null or prev_close = 0 then 0\n                        else (close / prev_close) - 1\n                    end\n            )\n        ) over (\n            partition by index_code\n            order by trade_date\n        ) as log_cumret,\n\n        -- 20 \u65e5\u6eda\u52a8\u5e73\u5747\u6536\u76ca\n        avg(\n            case \n                when prev_close is null or prev_close = 0 then 0\n                else (close / prev_close) - 1\n            end\n        ) over (\n            partition by index_code\n            order by trade_date\n            rows between 19 preceding and current row\n        ) as rolling_20d_avg_return,\n\n        -- 20 \u65e5\u6eda\u52a8\u6ce2\u52a8\u7387\uff08\u6807\u51c6\u5dee\uff09\n        stddev_samp(\n            case \n                when prev_close is null or prev_close = 0 then 0\n                else (close / prev_close) - 1\n            end\n        ) over (\n            partition by index_code\n            order by trade_date\n            rows between 19 preceding and current row\n        ) as rolling_20d_vol\n\n    from base\n)\n\nselect\n    r.date_key,\n    r.trade_date,\n    r.index_code,\n    r.open, r.high, r.low, r.close,\n    r.volume, r.amount,\n\n    r.daily_return,\n    exp(r.log_cumret) - 1 as cumulative_return,   -- \u628a log \u7d2f\u8ba1\u6536\u76ca\u8f6c\u56de\u666e\u901a\u7d2f\u8ba1\u6536\u76ca\n    r.rolling_20d_avg_return,\n    r.rolling_20d_vol,\n\n    -- \u8fde\u63a5\u65e5\u671f\u7ef4\u5ea6\uff0c\u8865\u5145 year / month / weekday\n    d.year,\n    d.month,\n    d.quarter,\n    d.weekday_short,\n    d.weekday_full\n\nfrom returns r\nleft join FIVETRAN_DATABASE.MLDS430_KOALA_INDEX_RAW.dim_date d\n  on r.date_key = d.date_key", "relation_name": "FIVETRAN_DATABASE.MLDS430_KOALA_INDEX_RAW.fact_index_daily", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T00:34:25.600485Z", "completed_at": "2025-11-28T00:34:25.611229Z"}, {"name": "execute", "started_at": "2025-11-28T00:34:25.616111Z", "completed_at": "2025-11-28T00:34:25.616111Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04785323143005371, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.index_dbt.not_null_stg_index_daily_index_code.8d8fa0e9ec", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect index_code\nfrom FIVETRAN_DATABASE.MLDS430_KOALA_INDEX_RAW.stg_index_daily\nwhere index_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T00:34:25.626848Z", "completed_at": "2025-11-28T00:34:25.650287Z"}, {"name": "execute", "started_at": "2025-11-28T00:34:25.653216Z", "completed_at": "2025-11-28T00:34:25.653216Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.034177303314208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.index_dbt.not_null_stg_index_daily_trade_date.28b4e69eba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect trade_date\nfrom FIVETRAN_DATABASE.MLDS430_KOALA_INDEX_RAW.stg_index_daily\nwhere trade_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T00:34:25.632707Z", "completed_at": "2025-11-28T00:34:25.652239Z"}, {"name": "execute", "started_at": "2025-11-28T00:34:25.655168Z", "completed_at": "2025-11-28T00:34:25.655168Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0341796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.index_dbt.not_null_stg_index_daily_unique_key.db9c92c9fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unique_key\nfrom FIVETRAN_DATABASE.MLDS430_KOALA_INDEX_RAW.stg_index_daily\nwhere unique_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T00:34:25.638565Z", "completed_at": "2025-11-28T00:34:25.654194Z"}, {"name": "execute", "started_at": "2025-11-28T00:34:25.657123Z", "completed_at": "2025-11-28T00:34:25.657123Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03515768051147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.index_dbt.unique_stg_index_daily_unique_key.9cad6b5a3a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    unique_key as unique_field,\n    count(*) as n_records\n\nfrom FIVETRAN_DATABASE.MLDS430_KOALA_INDEX_RAW.stg_index_daily\nwhere unique_key is not null\ngroup by unique_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T00:34:25.645405Z", "completed_at": "2025-11-28T00:34:25.655168Z"}, {"name": "execute", "started_at": "2025-11-28T00:34:25.658096Z", "completed_at": "2025-11-28T00:34:25.658096Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.034171342849731445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.index_dbt.not_null_fact_index_daily_date_key.309d366459", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_key\nfrom FIVETRAN_DATABASE.MLDS430_KOALA_INDEX_RAW.fact_index_daily\nwhere date_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T00:34:25.662983Z", "completed_at": "2025-11-28T00:34:25.668842Z"}, {"name": "execute", "started_at": "2025-11-28T00:34:25.669818Z", "completed_at": "2025-11-28T00:34:25.669818Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00976705551147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.index_dbt.not_null_fact_index_daily_index_code.f6ad2974af", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect index_code\nfrom FIVETRAN_DATABASE.MLDS430_KOALA_INDEX_RAW.fact_index_daily\nwhere index_code is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 2.815840005874634, "args": {"log_level_file": "debug", "exclude": [], "log_format_file": "debug", "quiet": false, "empty_catalog": false, "state_modified_compare_more_unrendered_values": false, "version_check": true, "require_generic_test_arguments_property": true, "partial_parse_file_diff": true, "static": false, "require_resource_names_without_spaces": true, "require_yaml_configuration_for_mf_time_spines": false, "log_file_max_bytes": 10485760, "indirect_selection": "eager", "select": [], "require_nested_cumulative_type_params": false, "invocation_command": "dbt docs generate", "favor_state": false, "strict_mode": false, "use_colors_file": true, "project_dir": "C:\\Users\\shenz\\Desktop\\index_dbt", "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": true, "validate_macro_args": false, "which": "generate", "require_all_warnings_handled_by_warn_error": false, "printer_width": 80, "print": true, "skip_nodes_if_on_run_start_fails": false, "static_parser": true, "show_all_deprecations": false, "cache_selected_only": false, "source_freshness_run_project_hooks": true, "use_fast_test_edges": false, "log_format": "default", "log_level": "info", "log_path": "C:\\Users\\shenz\\Desktop\\index_dbt\\logs", "vars": {}, "show_resource_report": false, "profiles_dir": "C:\\Users\\shenz\\Desktop\\index_dbt", "warn_error_options": {"error": [], "warn": [], "silence": []}, "upload_to_artifacts_ingest_api": false, "macro_debugging": false, "state_modified_compare_vars": false, "introspect": true, "require_batched_execution_for_custom_microbatch_strategy": false, "populate_cache": true, "use_colors": true, "compile": true, "send_anonymous_usage_stats": true, "partial_parse": true, "defer": false}}